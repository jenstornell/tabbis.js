"use strict";function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}var tabbisClass=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"init",value:function(t){this.thisOptions(t),this.thisMemory(),this.setup()}},{key:"setup",value:function(){var t=this,e=document.querySelectorAll(this.options.paneGroup);document.querySelectorAll(this.options.tabGroup).forEach((function(r,n){var a=e[n],i=t.getActiveIndex(r,n);r.setAttribute("role","tablist"),t.resetTabs(_toConsumableArray(r.children)),t.resetPanes(_toConsumableArray(a.children)),_toConsumableArray(r.children).forEach((function(e,r){var i=a.children[r];t.addTabAttributes(e,n),t.addPaneAttributes(e,i),e.groupIndex=n,e.addEventListener(t.options.trigger,(function(r){t.activate(r.currentTarget,e.groupIndex)})),t.options.keyboardNavigation&&e.addEventListener("keydown",(function(e){t.eventKey(e)}))})),null!==i&&(t.activateTab(_toConsumableArray(r.children)[i]),t.activatePane(_toConsumableArray(a.children)[i]))}))}},{key:"eventKey",value:function(t){[13,37,38,39,40].includes(t.keyCode)&&t.preventDefault(),13==t.keyCode?t.currentTarget.click():[39,40].includes(t.keyCode)?this.step(t,1):[37,38].includes(t.keyCode)&&this.step(t,-1)}},{key:"index",value:function(t){return _toConsumableArray(t.parentElement.children).indexOf(t)}},{key:"step",value:function(t,e){var r=t.currentTarget.parentElement.children;this.resetTabindex(r);var n=r[this.pos(t.currentTarget,r,e)];n.focus(),n.setAttribute("tabindex",0)}},{key:"resetTabindex",value:function(t){_toConsumableArray(t).forEach((function(t){t.setAttribute("tabindex","-1")}))}},{key:"pos",value:function(t,e,r){var n=this.index(t);return n+=r,e.length<=n?n=0:-1==n&&(n=e.length-1),n}},{key:"emitEvent",value:function(t,e){var r=new CustomEvent("tabbis",{bubbles:!0,detail:{tab:t,pane:e}});t.dispatchEvent(r)}},{key:"getActiveIndex",value:function(t,e){var r=this.loadMemory(e);if(void 0!==r)return r;var n=t.querySelector(this.options.tabActive);return n||(n=t.querySelector('[aria-selected="true"]')),n?this.index(n):!1!==this.options.tabActiveFallback?this.options.tabActiveFallback:null}},{key:"addTabAttributes",value:function(t,e){var r=this.index(t),n=this.options.prefix;t.setAttribute("role","tab"),t.setAttribute("aria-controls","".concat(n,"tabpanel-").concat(e,"-").concat(r)),t.setAttribute("id","".concat(n,"tab-").concat(e,"-").concat(r))}},{key:"addPaneAttributes",value:function(t,e){e.setAttribute("role","tabpanel"),e.setAttribute("aria-labelledby",t.getAttribute("id")),e.setAttribute("id",t.getAttribute("aria-controls")),e.setAttribute("tabindex","0")}},{key:"activate",value:function(t,e){var r=document.querySelector("#".concat(t.getAttribute("aria-controls")));this.resetTabs(_toConsumableArray(t.parentNode.children)),this.resetPanes(_toConsumableArray(r.parentElement.children)),this.activateTab(t),this.activatePane(r),this.saveMemory(t,e),this.emitEvent(t,r)}},{key:"activateTab",value:function(t){t.setAttribute("aria-selected","true"),t.setAttribute("tabindex","0")}},{key:"activatePane",value:function(t){t.removeAttribute("hidden")}},{key:"resetTabs",value:function(t){t.forEach((function(t){return t.setAttribute("aria-selected","false")})),this.resetTabindex(t)}},{key:"resetPanes",value:function(t){t.forEach((function(t){return t.setAttribute("hidden","")}))}},{key:"loadMemory",value:function(t){if(this.options.memory&&void 0!==this.memory[t]&&null!==this.memory[t])return parseInt(this.memory[t])}},{key:"saveMemory",value:function(t,e){this.options.memory&&(this.memory[e]=this.index(t),localStorage.setItem(this.options.memory,JSON.stringify(this.memory)))}},{key:"thisMemory",value:function(){if(this.options.memory){var t=localStorage.getItem(this.options.memory);this.memory=null!==t?JSON.parse(t):[]}}},{key:"defaults",value:function(){return{keyboardNavigation:!0,memory:!1,paneGroup:"[data-panes]",prefix:"",tabActive:"[data-active]",tabActiveFallback:0,tabGroup:"[data-tabs]",trigger:"click"}}},{key:"thisOptions",value:function(t){this.options=Object.assign(this.defaults(),t),!0===this.options.memory&&(this.options.memory="tabbis")}}]),t}();function tabbis(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new tabbisClass;e.init(t)}